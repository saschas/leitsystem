function d3threeD(e){function t(e){function t(){for(var t,r,a=!1,s;n>o&&(r=e.charCodeAt(o),r===g||r===y);)o++;for(t=r===T?o++:o;n>o;)if(r=e.charCodeAt(o),r>=f&&w>=r)o++;else{if(r!==M)return s=e.substring(t,o),a?parseFloat(s):parseInt(s);o++,a=!0}return s=e.substring(t),a?parseFloat(s):parseInt(s)}function r(){for(var t;n>o&&(t=e.charCodeAt(o),t===g||t===y);)o++;return t=e.charCodeAt(o),t===T||t>=f&&w>=t}var a=[],s=new THREE.Shape,o=1,n=e.length,i,h=0,c=0,l=0,d=0,u=null,p=null,E=0,m=0,v=0,H=0,_=0,k=0,R=0,S=0,x=0,C,A,L,z=!1,I=!1;for(i=e[0];n>=o;){switch(L=!0,i){case"M":z=!1,h=t(),c=t(),s.moveTo(h,c),i="L";break;case"m":h+=t(),c+=t(),s.moveTo(h,c),i="l";break;case"Z":case"z":L=!1,(h!==u||c!==p)&&s.lineTo(u,p),a.push(s),u=null,p=null,z=!0,s=new THREE.Shape,I=!0;break;case"L":case"H":case"V":l="V"===i?h:t(),d="H"===i?c:t(),s.lineTo(l,d),h=l,c=d;break;case"l":case"h":case"v":l="v"===i?h:h+t(),d="h"===i?c:c+t(),s.lineTo(l,d),h=l,c=d;break;case"C":E=t(),v=t();case"S":"S"===i&&(E=2*h-m,v=2*c-H),m=t(),H=t(),l=t(),d=t(),s.bezierCurveTo(E,v,m,H,l,d),h=l,c=d;break;case"c":E=h+t(),v=c+t();case"s":"s"===i&&(E=2*h-m,v=2*c-H),m=h+t(),H=c+t(),l=h+t(),d=c+t(),s.bezierCurveTo(E,v,m,H,l,d),h=l,c=d;break;case"Q":E=t(),v=t();case"T":"T"===i&&(E=2*h-E,v=2*c-v),l=t(),d=t(),s.quadraticCurveTo(E,v,l,d),h=l,c=d;break;case"q":E=h+t(),v=c+t();case"t":"t"===i&&(E=2*h-E,v=2*c-v),l=h+t(),d=c+t(),s.quadraticCurveTo(E,v,l,d),h=l,c=d;break;case"A":_=t(),k=t(),R=t()*b,S=t(),x=t(),l=t(),d=t(),_!==k&&console.warn("Forcing elliptical arc to be a circular one :(",_,k),E=Math.cos(R)*(h-l)/2+Math.sin(R)*(c-d)/2,v=-Math.sin(R)*(h-l)/2+Math.cos(R)*(c-d)/2;var G=Math.sqrt((_*_*k*k-_*_*v*v-k*k*E*E)/(_*_*v*v+k*k*E*E));S===x&&(G=-G),m=G*_*v/k,H=G*-k*E/_,C=Math.cos(R)*m-Math.sin(R)*H+(h+l)/2,A=Math.sin(R)*m+Math.cos(R)*H+(c+d)/2;var P=new THREE.Vector2(1,0),q=new THREE.Vector2((E-m)/_,(v-H)/k),F=Math.acos(P.dot(q)/P.length()/q.length());P.x*q.y-P.y*q.x<0&&(F=-F),P.x=(-E-m)/_,P.y=(-v-H)/k;var V=Math.acos(q.dot(P)/q.length()/P.length());q.x*P.y-q.y*P.x<0&&(V=-V),!x&&V>0&&(V-=2*Math.PI),x&&0>V&&(V+=2*Math.PI),s.absarc(C,A,_,F,F+V,x),h=l,c=d;break;case" ":break;default:throw new Error("weird path command: "+i)}null!==u||z||(u=h,p=c),L&&r()||(i=e[o++])}return I?a:(a.push(s),a)}function r(e,t){function r(){for(var e,r,o=!1,n;s>a&&(r=t.charCodeAt(a),r===g||r===y);)a++;for(e=r===T?a++:a;s>a;)if(r=t.charCodeAt(a),r>=f&&w>=r)a++;else{if(r!==M)return n=t.substring(e,a),o?parseFloat(n):parseInt(n);a++,o=!0}return n=t.substring(e),o?parseFloat(n):parseInt(n)}var a=t.indexOf("("),s=t.length,o=t.substring(0,a++);switch(o){case"translate":e.position.x=Math.floor(r()*m),e.position.y=Math.floor(r()*m);break;case"scale":e.scale.x=Math.floor(r()*m),e.scale.y=Math.floor(r()*m);break;default:console.warn("don't understand transform",t)}}function a(e,t){}function s(e,t,r){}function o(e,a){switch(e){case"x":this.position.x=Math.floor(a*m);break;case"y":this.position.y=Math.floor(a*m);break;case"class":this.clazz=a;break;case"stroke":case"fill":"string"!=typeof a&&(a=a.toString()),this.material.color.setHex(parseInt(a.substring(1),16));break;case"transform":r(this,a);break;case"d":var s=t(a),o=s.extrude(v);this.geometry=o,this.geometry.boundingSphere={radius:3},this.scale.set(m,m,m);break;default:throw new Error("no setter for: "+e)}}function n(e,t,r){this.setAttribute(t,r)}function i(e){THREE.Object3D.call(this),this.d3class="",e.add(this)}function h(){return new i(this)}function c(e,t,r,a){THREE.Mesh.call(this,r,a),this.d3tag=t,this.d3class="",e.add(this)}function l(){R||(R=new THREE.SphereGeometry(.5,H,_));var e=new THREE.MeshLambertMaterial({color:k});return new c(this,"sphere",R,e)}function d(){S||(S=new THREE.CubeGeometry(m,m,m));var e=new THREE.MeshLambertMaterial({color:k});return new c(this,"cube",S,e)}function u(){S||(S=new THREE.CubeGeometry(m,m,m));var e=new THREE.MeshLambertMaterial({color:k});return new c(this,"path",S,e)}function p(){THREE.Scene.call(this),this.renderer=null,this.camera=null,this.controls=null,this._d3_width=null,this._d3_height=null}function E(){function e(e){for(var t=new THREE.PlaneGeometry(e,e,4,4),r=0;4>r;r++){var a,o,n;switch(r){case 0:a=16711680,o=e/2,n=e/2;break;case 1:a=65280,o=e/2,n=-e/2;break;case 2:a=255,o=-e/2,n=-e/2;break;case 3:a=16776960,o=-e/2,n=e/2}var i=new THREE.MeshLambertMaterial({color:a}),h=new THREE.Mesh(t,i);h.position.set(o,n,-1),s.add(h)}}function t(){requestAnimationFrame(t,n.domElement),o.update()}function r(){n.render(s,a),c.update()}var a,s,o,n;s=new p,threeJsScene=s,a=s.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e5),s.add(a),o=s.controls=new THREE.TrackballControls(a),o.rotateSpeed=1,o.zoomSpeed=1.2,o.panSpeed=.8,o.noZoom=!1,o.noPan=!1,o.staticMoving=!0,o.dynamicDampingFactor=.3,o.keys=[65,83,68],o.addEventListener("change",r);var i=new THREE.SpotLight(16777215);i.position.set(-5e4,5e4,1e5),s.add(i);var h=new THREE.SpotLight(8947848);h.position.set(5e4,-5e4,-1e5),s.add(h),n=s.renderer=new THREE.WebGLRenderer({}),this.appendChild(n.domElement);var c=new Stats;return c.domElement.style.position="absolute",c.domElement.style.top="0px",c.domElement.style.zIndex=100,this.appendChild(c.domElement),t(),s}const b=Math.PI/180,m=1,f=48,w=57,g=44,y=32,M=46,T=45;transformSVGPathExposed=t,applySVGTransformExposed=r;var v={amount:20,bevelEnabled:!0,material:0,extrudeMaterial:0};i.prototype=new THREE.Object3D,i.prototype.constructor=i,i.prototype.d3tag="g",i.prototype.setAttribute=o,i.prototype.setAttributeNS=n,c.prototype=new THREE.Mesh,c.prototype.constructor=c,c.prototype.setAttribute=o,c.prototype.setAttributeNS=n;const H=16,_=16,k=13369344;var R=null,S=null;p.prototype=new THREE.Scene,p.prototype.constructor=p,p.prototype._setBounds=function(){this.renderer.setSize(this._d3_width,this._d3_height);var e=this.camera.aspect;this.camera.position.set(this._d3_width*m/2,this._d3_height*m/2,Math.max(this._d3_width*m/Math.sqrt(2),this._d3_height*m/Math.sqrt(2))),this.controls.target.set(this.camera.position.x,this.camera.position.y,0),console.log("camera:",this.camera.position.x,this.camera.position.y,this.camera.position.z)},p.prototype.setAttribute=function(e,t){switch(e){case"width":this._d3_width=t,this._d3_height&&this._setBounds();break;case"height":this._d3_height=t,this._d3_width&&this._setBounds()}}}var transformSVGPathExposed,$d3g={};d3threeD($d3g);